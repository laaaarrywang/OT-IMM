# Repository Guidelines

## Project Structure & Module Organization
Core Python modules live in `interflow/` (e.g., `stochastic_interpolant.py`, `realnvp.py`, `fabrics.py`) and are written as importable utilities; keep new flows or interpolants in this package. Parameter sweeps belong in `configs/` (hand-tuned baselines) and `tune_configs/` (generated by helper scripts). Experiment artifacts (plots, CSVs) are stored under `results*/`, while raw scheduler output goes to `slurm_logs/`. Use `notebooks/` for exploratory analysis and stash one-off experiments in `obsolete_files/` to avoid polluting the main APIs.

## Build, Test, and Development Commands
Run `python generate_tuning_configs.py` to refresh the default 10-job sweep in `tune_configs/`. `python hyperparameter_configs.py` emits the checkerboard sweep mirrored in `configs/`. Use `python analyze_tuning_results.py` after SLURM jobs finish to aggregate metrics into `results0929/`. Notebook quick-starts rely on double precision; launch them with `jupyter lab` from the repo root. For cluster work, follow `HOW_TO_LAUNCH.md`, place your `submit_tuning_batch.sh` alongside it, and invoke the script exactly as documented.

## Coding Style & Naming Conventions
Follow PEP 8 with 4-space indentation and keep lines under ~100 characters. Prefer explicit type hints and docstrings as shown in `interflow/realnvp.py`. Use `snake_case` for functions and config keys (`create_vector_flow`, `lr_flow`) and reserve `CamelCase` for modules and classes. Ensure tensors land on the correct device and dtype (most differentiability checks expect `torch.float64`). When adding configs, stick to lowercase, hyphen-free names (`deeper_wider`) to match downstream parsers.

## Testing Guidelines
Unit checks live alongside the code under `interflow/`. Run `pytest interflow/test_nonlinear_interpolant.py` for boundary and derivative coverage. For differentiability or invertibility regressions, import helpers from `interflow/updated_quick_run_functions.py` inside notebooks or scripts and execute the quick-run diagnostics before merging. Collect new regression plots under `results*/` and summarize any skipped tests in the PR description.

## Commit & Pull Request Guidelines
Commits should be concise, present-tense summaries (`add U-net velocity`, `debug nonlinear SI`). Reference related configs or experiments in the body and note any follow-up runs. Pull requests need: context, highlights of touched modules, test or benchmark evidence (attach plots from `results*/`), and relevant SLURM job IDs. Link issues where applicable and request review before launching large sweeps.

## Experiment Tracking
Archive generated assets under a new timestamped folder in `results/` and push only lightweight artifacts (plots, CSVs). Rotate `slurm_logs/` by moving older files into a dated subfolder before starting fresh batches so diagnostics stay searchable.
